<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Your First Verbs â€” ZTF Dictionary</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#F7F3EC;
      --fg:#0B0B0B;
      --muted:#686868;
      --accent:#5b5bd6;
      --radius:14px;
    }
    html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Inter,Helvetica,Arial,sans-serif}
    header{padding:28px 20px 10px;max-width:1200px;margin:0 auto}
    h1{margin:0 0 8px;font-size:28px;font-weight:800;letter-spacing:.2px}
    .sub{color:var(--muted);font-size:14px}
    .bar{display:flex;gap:10px;align-items:center;margin-top:16px}
    input[type="search"]{
      flex:1; padding:12px 14px; border:1px solid #ddd; border-radius:var(--radius);
      font-size:14px; background:#fff;
    }
    .badge{font-size:12px;color:#fff;background:var(--accent);padding:6px 10px;border-radius:999px}
    main{max-width:1200px;margin:16px auto 80px;padding:0 20px}
    table{width:100%;border-collapse:separate;border-spacing:0 10px}
    thead th{font-size:12px;text-transform:uppercase;letter-spacing:.6px;color:var(--muted);text-align:left;padding:0 10px}
    tbody tr{background:#fff;border-radius:var(--radius);box-shadow:0 2px 10px rgba(0,0,0,.06)}
    tbody td{padding:14px 10px;vertical-align:middle}
    tbody td:first-child{width:44px;text-align:center}
    .verb{font-weight:700}
    .ipa{font-family:ui-monospace, SFMono-Regular, Menlo, monospace; font-size:13px; color:#444}
    .literal{color:#111}
    .context{color:#333}
    .actions{display:flex;gap:8px;align-items:center}
    button.play{
      border:1px solid #ddd;background:#fff;border-radius:10px;padding:8px 10px;font-size:13px;cursor:pointer;
    }
    button.play:hover{border-color:#bbb}
    .flag{font-size:16px;margin-right:6px}
    .empty{color:#b00020;font-size:12px}
    footer{max-width:1200px;margin:30px auto;padding:0 20px 40px;color:var(--muted);font-size:12px}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
    @media (max-width: 860px){
      .hide-sm{display:none}
      .ipa{display:block;margin-top:4px}
    }

    /* --- List view (new) --- */
    .list-wrap{margin-top:30px}
    .list-head{font-size:12px;text-transform:uppercase;letter-spacing:.6px;color:var(--muted);margin:0 0 10px}
    .vlist{list-style:none;margin:0;padding:0;display:grid;grid-template-columns:1fr;gap:12px}
    .vlist li{background:#fff;border-radius:var(--radius);box-shadow:0 2px 10px rgba(0,0,0,.06);padding:14px}
    .item-row{display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap}
    .em{font-size:22px;line-height:1}
    .vverb{font-weight:800}
    .meta{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .players{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    audio{height:30px}
    .labels{display:grid;gap:6px;margin-top:8px}
    .label{font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.4px}
    .val{font-size:14px}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>
  <header>
    <h1>Your First Verbs</h1>
    <div class="sub">ZTF Dictionary â€” Ã¡udio ðŸ‡ºðŸ‡¸/ðŸ‡¬ðŸ‡§, traduÃ§Ã£o literal e contextual.</div>
    <div class="bar">
      <input id="search" type="search" placeholder="Search verbs or translationsâ€¦" />
      <span class="badge" id="count">0 items</span>
    </div>
  </header>

  <main>
    <!-- Original TABLE (unchanged layout) -->
    <table>
      <thead>
        <tr>
          <th>Emoji</th>
          <th>Verb</th>
          <th class="hide-sm">IPA</th>
          <th>Audio</th>
          <th>Literal</th>
          <th>Contextual</th>
        </tr>
      </thead>
      <tbody id="rows"></tbody>
    </table>

    <!-- New LIST (full data with inline players) -->
    <section class="list-wrap">
      <h2 class="list-head">Full list</h2>
      <ul id="vlist" class="vlist"></ul>
    </section>
  </main>

  <footer>
    Tip: arquivos de Ã¡udio ficam em <code>/audios</code> com nomes <code>to-verb.us.mp3</code> e <code>to-verb.uk.mp3</code>.
  </footer>

  <audio id="player" class="sr-only"></audio>

  <script>
    const CSV_URL = 'your_first_verbs.csv';
    const AUDIO_BASE = './audios/';

    function slugifyVerb(infinitive){
      return infinitive
        .toLowerCase()
        .trim()
        .replace(/^to\s+/, 'to-')
        .normalize('NFD').replace(/[\u0300-\u036f]/g, '')
        .replace(/[^a-z0-9]+/g, '-')
        .replace(/^-+|-+$/g, '');
    }

    function audioUrl(infinitive, accent){
      return `${AUDIO_BASE}${slugifyVerb(infinitive)}.${accent}.mp3`;
    }

    function play(infinitive, accent){
      const src = audioUrl(infinitive, accent);
      const player = document.getElementById('player');
      player.src = src;
      player.play().catch(()=>{});
    }

    function rowTemplate(item){
      const emoji = item['Emoji'] || 'ðŸ”¹';
      const verb = item['infinitive_verb'] || '';
      const ipa = item['infinitive_phonetic_us'] || '';
      const literal = item['literal_translation'] || '';
      const contextual = item['contextual_translation'] || '';

      return `
        <tr>
          <td>${emoji}</td>
          <td class="verb">${verb}</td>
          <td class="ipa hide-sm">${ipa}</td>
          <td class="actions">
            <button class="play" onclick="play('${verb.replace(/'/g, "\'")}', 'us')"><span class="flag">ðŸ‡ºðŸ‡¸</span>Play</button>
            <button class="play" onclick="play('${verb.replace(/'/g, "\'")}', 'uk')"><span class="flag">ðŸ‡¬ðŸ‡§</span>Play</button>
          </td>
          <td class="literal">${literal}</td>
          <td class="context">${contextual}</td>
        </tr>
      `;
    }

    function listItemTemplate(item){
      const emoji = item['Emoji'] || 'ðŸ”¹';
      const verb = item['infinitive_verb'] || '';
      const ipa = item['infinitive_phonetic_us'] || '';
      const literal = item['literal_translation'] || '';
      const contextual = item['contextual_translation'] || '';

      const us = audioUrl(verb, 'us');
      const uk = audioUrl(verb, 'uk');

      return `
        <li>
          <div class="item-row">
            <div class="em">${emoji}</div>
            <div>
              <div class="meta">
                <div class="vverb">${verb}</div>
                <div class="ipa">${ipa}</div>
              </div>
              <div class="players" aria-label="audio players">
                <div><span class="flag">ðŸ‡ºðŸ‡¸</span><audio controls preload="none" src="${us}"></audio></div>
                <div><span class="flag">ðŸ‡¬ðŸ‡§</span><audio controls preload="none" src="${uk}"></audio></div>
              </div>
              <div class="labels">
                <div><span class="label">Literal:</span> <span class="val">${literal}</span></div>
                <div><span class="label">Contextual:</span> <span class="val">${contextual}</span></div>
              </div>
            </div>
          </div>
        </li>
      `;
    }

    function render(data){
      const q = (document.getElementById('search').value || '').toLowerCase().trim();
      const filtered = !q ? data : data.filter(it => {
        const fields = [
          it['Emoji'],
          it['infinitive_verb'],
          it['infinitive_phonetic_us'],
          it['literal_translation'],
          it['contextual_translation']
        ].join(' ').toLowerCase();
        return fields.includes(q);
      });

      document.getElementById('count').textContent = `${filtered.length} item${filtered.length!==1?'s':''}`;

      // Table rows
      const rows = filtered.map(rowTemplate).join('');
      document.getElementById('rows').innerHTML = rows;

      // List items
      const items = filtered.map(listItemTemplate).join('');
      document.getElementById('vlist').innerHTML = items;
    }

    function init(){
      Papa.parse(CSV_URL, {
        header: true,
        download: true,
        complete: (results) => {
          const data = results.data.filter(Boolean);
          const search = document.getElementById('search');
          search.addEventListener('input', () => render(data));
          render(data);
        },
        error: (err) => {
          console.error('CSV error', err);
          document.getElementById('count').textContent = 'Error loading CSV';
        }
      });
    }

    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
